<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FFS - Frequent Failed Skills</title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="past-papers.css">
</head>
<body>
    <div class="ffs-container">
        <a href="chemistry-tracker.html" class="back-btn">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M12 4L6 10L12 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Back to Papers
        </a>

        <div class="header">
            <h1>FFS - Frequent Failed Skills</h1>
            <p>Track your silly mistakes and learn from them</p>
        </div>

        <div class="ffs-explanation">
            <h2>What is FFS? üòÖ</h2>
            <p>
                FFS stands for "Frequent Failed Skills" - a place to document those annoying mistakes you keep making.
                We all make silly errors, but the key is to learn from them!
            </p>
            <ul>
                <li>Always forgetting to round to 2 decimal places?</li>
                <li>Constantly missing units in your answers?</li>
                <li>Making the same calculation error repeatedly?</li>
                <li>Forgetting specific exam technique details?</li>
            </ul>
            <p style="margin-top: 16px;">
                Document them here so you never forget again! Review before each exam to avoid losing easy marks.
            </p>
        </div>

        <div class="stats-row" id="statsRow">
            <!-- Stats will be loaded here -->
        </div>

        <div class="add-mistake-section">
            <h3>Add New Mistake</h3>
            <form class="mistake-form" onsubmit="addMistake(event)">
                <div class="form-group">
                    <label class="form-label">Mistake Title *</label>
                    <input type="text" class="form-input" id="mistakeTitle" required
                        placeholder="e.g., Forgetting to round to 2 d.p.">
                </div>

                <div class="form-group">
                    <label class="form-label">Type *</label>
                    <select class="form-select" id="mistakeType" required>
                        <option value="rounding">Rounding</option>
                        <option value="units">Units</option>
                        <option value="calculation">Calculation Error</option>
                        <option value="formatting">Formatting/Presentation</option>
                        <option value="theory">Theory Misunderstanding</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Description *</label>
                    <textarea class="form-textarea" id="mistakeDescription" required
                        placeholder="Describe what went wrong and when it happened..."></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">How to Avoid This *</label>
                    <textarea class="form-textarea" id="mistakeSolution" required
                        placeholder="Write down how to prevent this mistake in the future..."></textarea>
                </div>

                <button type="submit" class="add-btn">+ Add Mistake</button>
            </form>
        </div>

        <div class="filter-section">
            <div class="filter-buttons" id="filterButtons">
                <button class="filter-btn active" onclick="filterMistakes('all')">All</button>
                <button class="filter-btn" onclick="filterMistakes('rounding')">Rounding</button>
                <button class="filter-btn" onclick="filterMistakes('units')">Units</button>
                <button class="filter-btn" onclick="filterMistakes('calculation')">Calculation</button>
                <button class="filter-btn" onclick="filterMistakes('formatting')">Formatting</button>
                <button class="filter-btn" onclick="filterMistakes('theory')">Theory</button>
                <button class="filter-btn" onclick="filterMistakes('other')">Other</button>
            </div>
        </div>

        <div class="mistakes-grid" id="mistakesGrid">
            <!-- Mistakes will be loaded here -->
        </div>
    </div>

    <script>
        let mistakes = [];
        let currentFilter = 'all';

        // Initialize
        function init() {
            loadMistakes();
            renderStats();
            renderMistakes();
        }

        // Load mistakes from localStorage
        function loadMistakes() {
            const saved = localStorage.getItem('chemistry-ffs-mistakes');
            if (saved) {
                mistakes = JSON.parse(saved);
            } else {
                // Add example mistakes
                mistakes = [
                    {
                        id: Date.now(),
                        title: "Always round to 2 decimal places",
                        type: "rounding",
                        description: "Keep forgetting to round final answers to 2 d.p. in calculations. Lost marks on equilibrium constant question.",
                        solution: "Write 'ROUND 2DP' at the top of every page. Check every numerical answer before moving on.",
                        dateAdded: new Date().toISOString()
                    }
                ];
                saveMistakes();
            }
        }

        // Save mistakes to localStorage
        function saveMistakes() {
            localStorage.setItem('chemistry-ffs-mistakes', JSON.stringify(mistakes));
        }

        // Add mistake
        function addMistake(event) {
            event.preventDefault();

            const newMistake = {
                id: Date.now(),
                title: document.getElementById('mistakeTitle').value,
                type: document.getElementById('mistakeType').value,
                description: document.getElementById('mistakeDescription').value,
                solution: document.getElementById('mistakeSolution').value,
                dateAdded: new Date().toISOString()
            };

            mistakes.unshift(newMistake); // Add to beginning
            saveMistakes();

            // Clear form
            document.getElementById('mistakeTitle').value = '';
            document.getElementById('mistakeDescription').value = '';
            document.getElementById('mistakeSolution').value = '';

            renderStats();
            renderMistakes();
        }

        // Delete mistake
        function deleteMistake(id) {
            if (confirm('Are you sure you want to delete this mistake?')) {
                mistakes = mistakes.filter(m => m.id !== id);
                saveMistakes();
                renderStats();
                renderMistakes();
            }
        }

        // Filter mistakes
        function filterMistakes(type) {
            currentFilter = type;

            // Update active button
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            renderMistakes();
        }

        // Render stats
        function renderStats() {
            const types = ['rounding', 'units', 'calculation', 'formatting', 'theory', 'other'];
            const typeCounts = {};
            types.forEach(type => {
                typeCounts[type] = mistakes.filter(m => m.type === type).length;
            });

            document.getElementById('statsRow').innerHTML = `
                <div class="stat-box">
                    <div class="stat-value">${mistakes.length}</div>
                    <div class="stat-label">Total Mistakes</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value">${typeCounts.rounding}</div>
                    <div class="stat-label">Rounding</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value">${typeCounts.units}</div>
                    <div class="stat-label">Units</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value">${typeCounts.calculation}</div>
                    <div class="stat-label">Calculations</div>
                </div>
            `;
        }

        // Render mistakes
        function renderMistakes() {
            const container = document.getElementById('mistakesGrid');
            const filtered = currentFilter === 'all'
                ? mistakes
                : mistakes.filter(m => m.type === currentFilter);

            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>No mistakes tracked yet</h3>
                        <p>Start documenting your common errors to improve your exam performance!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filtered.map(mistake => `
                <div class="mistake-card">
                    <div class="mistake-header">
                        <span class="mistake-type ${mistake.type}">${mistake.type}</span>
                        <div class="mistake-actions">
                            <button class="action-btn delete-btn" onclick="deleteMistake(${mistake.id})" title="Delete">
                                üóëÔ∏è
                            </button>
                        </div>
                    </div>
                    <h3 class="mistake-title">${mistake.title}</h3>
                    <p class="mistake-description">${mistake.description}</p>
                    <div class="mistake-solution">
                        <strong>‚úÖ How to avoid:</strong>
                        ${mistake.solution}
                    </div>
                    <div class="mistake-meta">
                        <span>Added: ${new Date(mistake.dateAdded).toLocaleDateString()}</span>
                    </div>
                </div>
            `).join('');
        }

        // Initialize on load
        init();
    </script>
</body>
</html>
